package com.galya.business.productioncapacity.persistence;

import static com.galya.business.productioncapacity.persistence.ProductionCapacityDatabaseManager.VARCHAR_MAX_LENGTH;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;

import com.galya.business.productioncapacity.model.EconomicActivityGroup;

public class EconomicActivityGroupTableHelper implements TableHelper {

    private static final String DATABASE_NAME = ProductionCapacityDatabaseManager.DATABASE_NAME;

    private static final String EA_GROUP_TABLE = "Economic_Activity_Group";

    private static final String EA_GROUP_TABLE_ID = "_id";
    private static final String EA_GROUP_TABLE_GROUP_ID = "id";
    private static final String EA_GROUP_TABLE_GROUP_NAME = "name";
    private static final String EA_GROUP_TABLE_DIVISION_ID = "division_id";

    private static final String EA_GROUP_TABLE_CREATION_QUERY = "CREATE TABLE IF NOT EXISTS " + EA_GROUP_TABLE + " ("
            + EA_GROUP_TABLE_ID + " integer primary key autoincrement, " + EA_GROUP_TABLE_GROUP_ID + " varchar("
            + VARCHAR_MAX_LENGTH + ") unique not null, " + EA_GROUP_TABLE_GROUP_NAME + " varchar(" + VARCHAR_MAX_LENGTH
            + ") not null, " + EA_GROUP_TABLE_DIVISION_ID + " varchar(" + VARCHAR_MAX_LENGTH + ") not null" + ");";

    private static EconomicActivityGroupTableHelper instance;

    public static EconomicActivityGroupTableHelper getInstance() {
        if (instance == null) {
            return new EconomicActivityGroupTableHelper();
        }
        return instance;
    }

    private EconomicActivityGroupTableHelper() {
    }

    @Override
    public String getDatabaseName() {
        return DATABASE_NAME;
    }

    @Override
    public String getTableName() {
        return EA_GROUP_TABLE;
    }

    @Override
    public void createTable(Connection connection) throws SQLException {
        Statement stmt = connection.createStatement();
        stmt.executeUpdate(EA_GROUP_TABLE_CREATION_QUERY);
        stmt.close();
    }

    @Override
    public void populateDefaultValues(Connection connection) throws SQLException {
        PreparedStatement stmt = connection
                .prepareStatement("INSERT INTO "
                        + EA_GROUP_TABLE
                        + " ("
                        + EA_GROUP_TABLE_GROUP_ID
                        + ", "
                        + EA_GROUP_TABLE_GROUP_NAME
                        + ", "
                        + EA_GROUP_TABLE_DIVISION_ID
                        + ") VALUES ('01.1', 'Отглеждане на едногодишни растения', '01'),('01.2', 'Отглеждане на многогодишни насаждения', '01'),('01.3', 'Дейности на разсадници, без горските', '01'),('01.4', 'Животновъдство', '01'),('01.5', 'Комбинирано растениевъдно-животновъдно стопанство', '01'),('01.6', 'Спомагателни дейности в селското стопанство', '01'),('01.7', 'Лов и спомагателни дейности', '01'),('02.1', 'Възпроизводство на гори', '02'),('02.2', 'Дърводобив', '02'),('02.3', 'Събиране на диворастящи и недървесни продукти', '02'),('02.4', 'Спомагателни дейности в горското стопанство', '02'),('03.1', 'Риболов', '03'),('03.2', 'Развъждане и отглеждане на риба и други водни организми', '03'),('05.1', 'Добив на антрацитни и черни въглища', '05'),('05.2', 'Добив на кафяви и лигнитни въглища', '05'),('06.1', 'Добив на нефт', '06'),('06.2', 'Добив на природен газ', '06'),('07.1', 'Добив на железни руди', '07'),('07.2', 'Добив на уранови, ториеви и руди на цветни метали', '07'),('08.1', 'Добив на скални материали, пясък и глина', '08'),('08.9', 'Добив на други неметални материали и суровини', '08'),('09.1', 'Спомагателни дейности в добива на нефт и природен газ', '09'),('09.9', 'Спомагателни дейности в добива, без добива на нефт и природен газ', '09'),('10.1', 'Производство и преработка на месо; производство на месни продукти, без готови ястия', '10'),('10.2', 'Преработка и консервиране на риба и други водни животни, без готови ястия', '10'),('10.3', 'Преработка и консервиране на плодове и зеленчуци, без готови ястия', '10'),('10.4', 'Производство на растителни и животински масла и мазнини', '10'),('10.5', 'Производство на мляко и млечни продукти', '10'),('10.6', 'Производство на мелничарски продукти, нишесте и нишестени продукти', '10'),('10.7', 'Производство на хлебни и тестени изделия', '10'),('10.8', 'Производство на други хранителни продукти', '10'),('10.9', 'Производство на готови храни за животни', '10'),('11.0', 'Производство на напитки', '11'),('12.0', 'Производство на тютюневи изделия', '12'),('13.1', 'Подготовка и предене на текстилни влакна', '13'),('13.2', 'Производство на тъкани', '13'),('13.3', 'Облагородяване на прежди, платове и облекло', '13'),('13.9', 'Производство на други текстилни изделия', '13'),('14.1', 'Производство на облекло, без кожухарско', '14'),('14.2', 'Производство на облекло и изделия от кожухарски кожи', '14'),('14.3', 'Производство на други трикотажни изделия', '14'),('15.1', 'Обработка на кожи; производство на изделия за пътуване и сарашки изделия', '15'),('15.2', 'Производство на обувки', '15'),('16.1', 'Разкрояване, рендосване и импрегниране на дървен материал', '16'),('16.2', 'Производство на изделия от дървен материал, корк, слама и материали за плетене', '16'),('17.1', 'Производство на влакнести полуфабрикати, хартия и картон', '17'),('17.2', 'Производство на изделия от хартия и картон', '17'),('18.1', 'Печатна дейност', '18'),('18.2', 'Възпроизвеждане на записани носители', '18'),('19.1', 'Производство на кокс и продукти на коксуването', '19'),('19.2', 'Производство на рафинирани нефтопродукти и брикети от въглища и торф', '19'),('20.1', 'Производство на основни химични вещества', '20'),('20.2', 'Производство на пестициди и други агрохимикали', '20'),('20.3', 'Производство на бои, лакове и подобни продукти, печатарско мастило и китове', '20'),('20.4', 'Производство на почистващи, миещи, тоалетни и козметични препарати', '20'),('20.5', 'Производство на други химични продукти', '20'),('20.6', 'Производство на изкуствени и синтетични влакна', '20'),('21.1', 'Производство на лекарствени вещества', '21'),('21.2', 'Производство на лекарствени продукти', '21'),('22.1', 'Производство на изделия от каучук', '22'),('22.2', 'Производство на изделия от пластмаси', '22'),('23.1', 'Производство на стъкло и изделия от стъкло', '23'),('23.2', 'Производство на огнеупорни изделия', '23'),('23.3', 'Производство на керамични изделия за строителството', '23'),('23.4', 'Производство на други порцеланови и керамични изделия', '23'),('23.5', 'Производство на цимент, вар и гипс', '23'),('23.6', 'Производство на изделия от бетон, гипс и цимент', '23'),('23.7', 'Рязане, профилиране и обработване на строителни и декоративни скални материали', '23'),('23.9', 'Производство на изделия от други неметални минерали', '23'),('24.1', 'Производство на чугун, стомана и феросплави', '24'),('24.2', 'Производство на тръби, кухи профили и фитинги за тях от стомана', '24'),('24.3', 'Производство на други продукти при първичната преработка на стомана', '24'),('24.4', 'Производство на основни благородни и други цветни метали', '24'),('24.5', 'Леене на метали', '24'),('25.1', 'Производство на метални изделия за строителството', '25'),('25.2', 'Производство на котли за централно отопление и радиатори с неелектрическо загряване; производство на цистерни, резервоари и контейнери от метал', '25'),('25.3', 'Производство на парни котли, без котли за централно отопление', '25'),('25.4', 'Производство на въоръжение и боеприпаси', '25'),('25.5', 'Коване, щамповане и валцуване на метал; прахова металургия', '25'),('25.6', 'Друго металообработване', '25'),('25.7', 'Производство на кухненски прибори, инструменти и железария', '25'),('25.9', 'Производство на други метални изделия', '25'),('26.1', 'Производство на електронни елементи и печатни платки', '26'),('26.2', 'Производство на компютърна техника', '26'),('26.3', 'Производство на радио-, телевизионна и далекосъобщителна техника', '26'),('26.4', 'Производство на битова електроника', '26'),('26.5', 'Производство на уреди и апарати за измерване, изпитване и навигация; производство на часовници', '26'),('26.6', 'Производство на излъчващи електромедицински и терапевтични апарати', '26'),('26.7', 'Производство на оптични уреди и елементи и фотографска техника', '26'),('26.8', 'Производство на магнитни и оптични носители, незаписани', '26'),('27.1', 'Производство на електрически двигатели, генератори и трансформатори и апарати за управление и разпределение на електрическа енергия', '27'),('27.2', 'Производство на акумулаторни батерии и акумулатори', '27'),('27.3', 'Производство на изолирани проводници и електроинсталационни изделия', '27'),('27.4', 'Производство на лампи и осветители', '27'),('27.5', 'Производство на битови уреди', '27'),('27.9', 'Производство на други електрически съоръжения', '27'),('28.1', 'Производство на машини с общо предназначение', '28'),('28.2', 'Производство на други машини с общо предназначение', '28'),('28.3', 'Производство на машини за селското и горското стопанство', '28'),('28.4', 'Производство на обработващи машини', '28'),('28.9', 'Производство на други машини със специално предназначение', '28'),('29.1', 'Производство на автомобили и техните двигатели', '29'),('29.2', 'Производство на купета и каросерии за автомобили; производство на ремаркета и полуремаркета', '29'),('29.3', 'Производство на части и принадлежности за автомобили', '29'),('30.1', 'Строителство на плавателни съдове', '30'),('30.2', 'Производство на локомотиви, мотриси и вагони', '30'),('30.3', 'Производство на въздухоплавателни и космически средства и техните двигатели', '30'),('30.4', 'Производство на бойни бронирани транспортни машини', '30'),('30.9', 'Производство на други превозни средства', '30'),('31.0', 'Производство на мебели', '31'),('32.1', 'Производство на бижута и подобни изделия', '32'),('32.2', 'Производство на музикални инструменти', '32'),('32.3', 'Производство на спортни стоки', '32'),('32.4', 'Производство на игри и детски играчки', '32'),('32.5', 'Производство на медицински и зъболекарски инструменти и средства', '32'),('32.9', 'Разнообразни производства, некласифицирани другаде', '32'),('33.1', 'Ремонт на метални изделия, машини и оборудване', '33'),('33.2', 'Инсталиране на машини и оборудване', '33'),('35.1', 'Производство, пренос и разпределение на електрическа енергия', '35'),('35.2', 'Производство и разпределение на газообразни горива по газоразпределителните мрежи', '35'),('35.3', 'Производство и разпределение на топлинна енергия', '35'),('36.0', 'Събиране, пречистване и доставяне на води', '36'),('37.0', 'Събиране, отвеждане и пречистване на отпадъчни води', '37'),('38.1', 'Събиране на отпадъци', '38'),('38.2', 'Обработване и обезвреждане на отпадъци', '38'),('38.3', 'Рециклиране на материали', '38'),('39.0', 'Възстановяване и други услуги по управление на отпадъци', '39'),('41.1', 'Дейности по реализиране на инвестиционни проекти за сгради', '41'),('41.2', 'Строителство на жилищни и нежилищни сгради', '41'),('42.1', 'Строителство на пътища, вкл. релсови', '42'),('42.2', 'Строителство на преносни и разпределителни проводи и мрежи', '42'),('42.9', 'Строителство на други съоръжения', '42'),('43.1', 'Разчистване и подготовка на строителната площадка', '43'),('43.2', 'Изграждане на инсталации', '43'),('43.3', 'Довършителни строителни дейности', '43'),('43.9', 'Други специализирани строителни дейности', '43'),('45.1', 'Търговия с автомобили', '45'),('45.2', 'Техническо обслужване и ремонт на автомобили', '45'),('45.3', 'Търговия с части и принадлежности за автомобили', '45'),('45.4', 'Търговия с мотоциклети и с части за тях, техническо обслужване и ремонт на мотоциклети', '45'),('46.1', 'Търговия на едро чрез посредничество', '46'),('46.2', 'Tърговия на едро със селскостопански суровини и живи животни', '46'),('46.3', 'Търговия на едро с хранителни стоки, напитки и тютюневи изделия', '46'),('46.4', 'Търговия на едро с нехранителни потребителски стоки', '46'),('46.5', 'Търговия на едро с компютърна и комуникационна техника', '46'),('46.6', 'Търговия на едро с други машини и оборудване със стопанско предназначение и части за тях', '46'),('46.7', 'Търговия на едро с неселскостопански междинни продукти, отпадъци и скрап', '46'),('46.9', 'Неспециализирана търговия на едро', '46'),('47.1', 'Търговия на дребно в неспециализирани магазини', '47'),('47.2', 'Търговия на дребно в специализирани магазини с хранителни стоки, напитки и тютюневи изделия', '47'),('47.3', 'Търговия на дребно с автомобилни горива и смазочни материали', '47'),('47.4', 'Търговия на дребно в специализирани магазини с компютърна и комуникационна техника и битова електроника', '47'),('47.5', 'Търговия на дребно в специализирани магазини с текстил, железария, стоки за обзавеждане и битови електроуреди', '47'),('47.7', 'Търговия на дребно в специализирани магазини с други нехранителни стоки', '47'),('47.8', 'Търговия на дребно на открити щандове и пазари', '47'),('47.9', 'Търговия на дребно извън търговски обекти', '47'),('49.1', 'Пътнически железопътен транспорт, междуселищен', '49'),('49.2', 'Товарен железопътен транспорт', '49'),('49.3', 'Друг пътнически сухопътен транспорт', '49'),('49.4', 'Товарен автомобилен транспорт и услуги по преместване', '49'),('49.5', 'Тръбопроводен транспорт', '49'),('50.1', 'Пътнически морски и крайбрежен транспорт', '50'),('50.2', 'Товарен морски и крайбрежен транспорт', '50'),('50.3', 'Пътнически транспорт по вътрешни водни пътища', '50'),('50.4', 'Товарен транспорт по вътрешни водни пътища', '50'),('51.1', 'Пътнически въздушен транспорт', '51'),('51.2', 'Товарен въздушен транспорт; космически транспорт', '51'),('52.1', 'Складиране и съхраняване на товари', '52'),('52.2', 'Спомагателни дейности в транспорта', '52'),('53.1', 'Дейност на пощи, предоставящи универсална пощенска услуга', '53'),('53.2', 'Други пощенски и куриерски дейности', '53'),('55.1', 'Хотели и подобни места за настаняване', '55'),('55.2', 'Туристическо и друго краткосрочно настаняване', '55'),('55.3', 'Къмпинги и терени за каравани и къмпинг-автомобили', '55'),('55.9', 'Други места за настаняване', '55'),('56.1', 'Дейност на ресторанти и заведения за бързо обслужване', '56'),('56.2', 'Приготвяне и доставяне на храна', '56'),('56.3', 'Дейност на питейни заведения', '56'),('58.1', 'Издаване на книги, периодични издания и друга издателска дейност', '58'),('58.2', 'Издаване на програмни продукти', '58'),('59.1', 'Производство и разпространение на филми и телевизионни предавания', '59'),('59.2', 'Звукозаписване и издаване на музика', '59'),('60.1', 'Създаване и излъчване на радиопрограми', '60'),('60.2', 'Създаване и излъчване на телевизионни програми', '60'),('61.1', 'Далекосъобщителна дейност чрез фиксирани мрежи', '61'),('61.2', 'Далекосъобщителна дейност по безжичен път', '61'),('61.3', 'Спътникова далекосъобщителна дейност', '61'),('61.9', 'Други далекосъобщителни дейности', '61'),('62.0', 'Дейности в областта на информационните технологии', '62'),('63.1', 'Обработка на данни, хостинг и подобни дейности; web- портали', '63'),('63.9', 'Други информационни услуги', '63'),('64.1', 'Парично посредничество', '64'),('64.2', 'Дейност на холдингови дружества', '64'),('64.3', 'Фондове за инвестиране и подобни финансови субекти', '64'),('64.9', 'Предоставяне на други финансови услуги, без застраховане и допълнително пенсионно осигуряване', '64'),('65.1', 'Застраховане', '65'),('65.2', 'Презастраховане', '65'),('65.3', 'Допълнително пенсионно осигуряване', '65'),('66.1', 'Спомагателни дейности във финансовите услуги, без застраховане и допълнително пенсионно осигуряване', '66'),('66.2', 'Спомагателни дейности в застраховането и допълнителното пенсионно осигуряване', '66'),('66.3', 'Управление на фондове', '66'),('68.1', 'Покупка и продажба на собствени недвижими имоти', '68'),('68.2', 'Даване под наем и експлоатация на собствени недвижими имоти', '68'),('68.3', 'Посредническа дейност по операции с недвижими имоти', '68'),('69.1', 'Юридически дейности', '69'),('69.2', 'Счетоводни и одиторски дейности; данъчни консултации', '69'),('70.1', 'Дейност на централни офиси', '70'),('70.2', 'Консултантски дейности в областта на управлението', '70'),('71.1', 'Архитектурни и инженерни дейности', '71'),('71.2', 'Технически изпитвания и анализи', '71'),('72.1', 'Научноизследователска и развойна дейност в областта на естествените, медицинските, селскостопанските и техническите науки', '72'),('72.2', 'Научноизследователска и развойна дейност в областта на обществените и хуманитарните науки', '72'),('73.1', 'Рекламна дейност', '73'),('73.2', 'Проучване на пазари и изследване на общественото мнение', '73'),('74.1', 'Специализирани дейности в областта на дизайна', '74'),('74.2', 'Дейности в областта на фотографията', '74'),('74.3', 'Преводаческа дейност', '74'),('74.9', 'Други професионални дейности, некласифицирани другаде', '74'),('75.0', 'Ветеринарномедицинска дейност', '75'),('77.1', 'Даване под наем и оперативен лизинг на автомобили', '77'),('77.2', 'Даване под наем и оперативен лизинг на лични и домакински вещи', '77'),('77.3', 'Даване под наем и оперативен лизинг на други машини и оборудване със стопанско предназначение', '77'),('77.4', 'Оперативен лизинг на интелектуална собственост и сходни продукти, без обектите на авторско право', '77'),('78.1', 'Посредническа дейност на агенции по наемане на работа', '78'),('78.2', 'Предоставяне на работна сила за временна заетост', '78'),('78.3', 'Други дейности по предоставяне на работна сила', '78'),('79.1', 'Туристическа агентска и операторска дейност', '79'),('79.9', 'Други дейности, свързани с пътувания и резервации', '79'),('80.1', 'Частна охранителна дейност, без използване на технически системи за сигурност', '80'),('80.2', 'Дейности в областта на технически системи за сигурност', '80'),('80.3', 'Дейности по разследване и издирване', '80'),('81.1', 'Комплексно обслужване на сгради', '81'),('81.2', 'Дейности по почистване', '81'),('81.3', 'Оформяне и поддържане на озеленени площи', '81'),('82.1', 'Административни и спомагателни офис дейности', '82'),('82.2', 'Дейност на телефонни центрове за услуги', '82'),('82.3', 'Организиране на конгреси и търговски изложения', '82'),('82.9', 'Спомагателно обслужване на стопанската дейност, некласифицирано другаде', '82'),('84.1', 'Държавно управление с общ, икономически и социален характер', '84'),('84.2', 'Услуги на държавното управление за обществото като цяло', '84'),('84.3', 'Държавно обществено осигуряване', '84'),('85.1', 'Предучилищно образование', '85'),('85.2', 'Начално образование (първи етап на основното образование)', '85'),('85.3', 'Прогимназиално (втори етап на основното образование) и средно образование', '85'),('85.4', 'Образование след завършено средно образование', '85'),('85.5', 'Други образователни дейности', '85'),('85.6', 'Спомагателни дейности в областта на образованието', '85'),('86.1', 'Дейност на болници', '86'),('86.2', 'Извънболнична лекарска практика', '86'),('86.9', 'Други дейности по хуманно здравеопазване', '86'),('87.1', 'Дейност на заведения със здравни грижи', '87'),('87.2', 'Социални грижи с настаняване за лица с умствена изостаналост, психичноболни и зависими от наркотици', '87'),('87.3', 'Социални грижи с настаняване за възрастни лица и хора с физически увреждания', '87'),('87.9', 'Други социални грижи с настаняване', '87'),('88.1', 'Социална работа без настаняване за възрастни лица и хора с увреждания', '88'),('88.9', 'Друга социална работа без настаняване', '88'),('90.0', 'Артистична и творческа дейност', '90'),('91.0', 'Други дейности в областта на културата', '91'),('92.0', 'Организиране на хазартни игри', '92'),('93.1', 'Дейности в областта на спорта', '93'),('93.2', 'Дейности, свързани с развлечения и отдих', '93'),('94.1', 'Дейност на бизнес организации, организации на работодатели и професионални организации', '94'),('94.2', 'Дейност на синдикални организации', '94'),('94.9', 'Дейност на други организации с нестопанска цел', '94'),('95.1', 'Ремонт на компютърна и комуникационна техника', '95'),('95.2', 'Ремонт на лични и домакински вещи', '95'),('96.0', 'Други персонални услуги', '96'),('97.0', 'Дейности на домакинства като работодатели на домашен персонал', '97'),('98.1', 'Недиференцирани дейности на домакинства по производство на стоки за собствено потребление', '98'),('98.2', 'Недиференцирани дейности на домакинства по производство на услуги за собствено потребление', '98'),('99.0', 'Дейности на екстериториални организации и служби', '99')");
        stmt.executeUpdate();
        stmt.close();
    }

    public List<EconomicActivityGroup> getAll() {
        List<EconomicActivityGroup> allGroups = new ArrayList<EconomicActivityGroup>();

        try (Connection connection = ProductionCapacityDatabaseManager.getConnection();) {
            PreparedStatement stmt = connection.prepareStatement("SELECT * FROM " + EA_GROUP_TABLE);
            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                int databaseId = rs.getInt(EA_GROUP_TABLE_ID);
                String divisionId = rs.getString(EA_GROUP_TABLE_GROUP_ID);
                String divisionName = rs.getString(EA_GROUP_TABLE_GROUP_NAME);
                String groupId = rs.getString(EA_GROUP_TABLE_DIVISION_ID);
                EconomicActivityGroup currentGroup = new EconomicActivityGroup(databaseId, divisionId, divisionName,
                        groupId);
                allGroups.add(currentGroup);
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return allGroups;
    }

    public List<EconomicActivityGroup> getByDivisionId(String divisionId) {
        List<EconomicActivityGroup> groupsBySectionId = new ArrayList<EconomicActivityGroup>();

        try (Connection connection = ProductionCapacityDatabaseManager.getConnection();) {
            PreparedStatement stmt = connection.prepareStatement("SELECT * FROM " + EA_GROUP_TABLE + " WHERE "
                    + EA_GROUP_TABLE_DIVISION_ID + "=?");
            stmt.setString(1, divisionId);
            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                int databaseId = rs.getInt(EA_GROUP_TABLE_ID);
                String groupId = rs.getString(EA_GROUP_TABLE_GROUP_ID);
                String groupName = rs.getString(EA_GROUP_TABLE_GROUP_NAME);
                EconomicActivityGroup currentClass = new EconomicActivityGroup(databaseId, groupId, groupName,
                        divisionId);
                groupsBySectionId.add(currentClass);
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return groupsBySectionId;
    }
}
